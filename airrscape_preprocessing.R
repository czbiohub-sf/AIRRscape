library(tidyverse)
### CODE FOR INTIAL IMPORTING SETLIFF 2018 HIV DATA FROM OAS AND COMBINING 100 RAW DATASETS INTO 12 DONOR TIMEPOINTS:
## wget commands and key combining filenames with datasets found in:
 ## bulk_download_hiv_heavybulk_subjectandlongitudinaldefined.csv
 ## after wget commands, run these R commands:
hiv.bulk.cap287.3y.b1 <- read_csv("SRR6206380_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap287.3y.b1 <- hiv.bulk.cap287.3y.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap287.3y.b2 <- read_csv("SRR6207009_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap287.3y.b2 <- hiv.bulk.cap287.3y.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap287.3y.A1 <- read_csv("SRR6207009_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap287.3y.A2 <- read_csv("SRR6206380_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap287.3y.D1 <- read_csv("SRR6206380_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap287.3y.D2 <- read_csv("SRR6207009_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap287.3y.G1 <- read_csv("SRR6206380_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap287.3y.M1 <- read_csv("SRR6206380_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap287.6m.b1 <- read_csv("SRR6206379_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap287.6m.b1 <- hiv.bulk.cap287.6m.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap287.6m.b2 <- read_csv("SRR6207016_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap287.6m.b2 <- hiv.bulk.cap287.6m.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap287.6m.A1 <- read_csv("SRR6207016_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap287.6m.A2 <- read_csv("SRR6206379_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap287.6m.D1 <- read_csv("SRR6207016_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap287.6m.D2 <- read_csv("SRR6206379_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap287.6m.G1 <- read_csv("SRR6206379_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap287.6m.M1 <- read_csv("SRR6206379_Heavy_IGHM.csv.gz", skip =1)

hiv.bulk.cap287.3y <- rbind(hiv.bulk.cap287.3y.b1,hiv.bulk.cap287.3y.b2,hiv.bulk.cap287.3y.A1,hiv.bulk.cap287.3y.A2,hiv.bulk.cap287.3y.D1,hiv.bulk.cap287.3y.D2,hiv.bulk.cap287.3y.G1,hiv.bulk.cap287.3y.M1)
hiv.bulk.cap287.3y <- hiv.bulk.cap287.3y  %>% filter(Redundancy > 1)
hiv.bulk.cap287.6m <- rbind(hiv.bulk.cap287.6m.b1,hiv.bulk.cap287.6m.b2,hiv.bulk.cap287.6m.A1,hiv.bulk.cap287.6m.A2,hiv.bulk.cap287.6m.D1,hiv.bulk.cap287.6m.D2,hiv.bulk.cap287.6m.G1,hiv.bulk.cap287.6m.M1)
hiv.bulk.cap287.6m <- hiv.bulk.cap287.6m %>% filter(Redundancy > 1)
#write.table(hiv.bulk.cap287.3y, "hiv_bulk_cap287_3y.tab", sep = "\t", row.names = FALSE, quote = FALSE)
#write.table(hiv.bulk.cap287.6m, "hiv_bulk_cap287_6m.tab", sep = "\t", row.names = FALSE, quote = FALSE)


hiv.bulk.cap301.3y.b1 <- read_csv("SRR6207006_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap301.3y.b1 <- hiv.bulk.cap301.3y.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap301.3y.b2 <- read_csv("SRR6206384_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap301.3y.b2 <- hiv.bulk.cap301.3y.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap301.3y.A1 <- read_csv("SRR6206384_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap301.3y.A2 <- read_csv("SRR6207006_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap301.3y.D1 <- read_csv("SRR6207006_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap301.3y.D2 <- read_csv("SRR6206384_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap301.3y.E1 <- read_csv("SRR6207006_Heavy_IGHE.csv.gz", skip =1)
hiv.bulk.cap301.3y.G1 <- read_csv("SRR6206384_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap301.3y.G2 <- read_csv("SRR6207006_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap301.3y.M1 <- read_csv("SRR6207006_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap301.3y.M2 <- read_csv("SRR6206384_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap301.6m.b1 <- read_csv("SRR6207012_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap301.6m.b1 <- hiv.bulk.cap301.6m.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap301.6m.b2 <- read_csv("SRR6206383_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap301.6m.b2 <- hiv.bulk.cap301.6m.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap301.6m.A1 <- read_csv("SRR6206383_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap301.6m.A2 <- read_csv("SRR6207012_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap301.6m.D1 <- read_csv("SRR6206383_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap301.6m.G1 <- read_csv("SRR6207012_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap301.6m.G2 <- read_csv("SRR6206383_Heavy_IGHG.csv.gz", skip =1)

hiv.bulk.cap301.3y <- rbind(hiv.bulk.cap301.3y.b1,hiv.bulk.cap301.3y.b2,hiv.bulk.cap301.3y.A1,hiv.bulk.cap301.3y.A2,hiv.bulk.cap301.3y.D1,hiv.bulk.cap301.3y.D2,hiv.bulk.cap301.3y.E1,hiv.bulk.cap301.3y.G1,hiv.bulk.cap301.3y.G2,hiv.bulk.cap301.3y.M1,hiv.bulk.cap301.3y.M2)
hiv.bulk.cap301.3y <- hiv.bulk.cap301.3y  %>% filter(Redundancy > 1)
hiv.bulk.cap301.6m <- rbind(hiv.bulk.cap301.6m.b1,hiv.bulk.cap301.6m.b2,hiv.bulk.cap301.6m.A1,hiv.bulk.cap301.6m.A2,hiv.bulk.cap301.6m.D1,hiv.bulk.cap301.6m.G1,hiv.bulk.cap301.6m.G2)
hiv.bulk.cap301.6m <- hiv.bulk.cap301.6m  %>% filter(Redundancy > 1)
#write.table(hiv.bulk.cap301.3y, "hiv_bulk_cap301_3y.tab", sep = "\t", row.names = FALSE, quote = FALSE)
#write.table(hiv.bulk.cap301.6m, "hiv_bulk_cap301_6m.tab", sep = "\t", row.names = FALSE, quote = FALSE)


hiv.bulk.cap312.3y.b1 <- read_csv("SRR6206375_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap312.3y.b1 <- hiv.bulk.cap312.3y.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap312.3y.b2 <- read_csv("SRR6207010_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap312.3y.b2 <- hiv.bulk.cap312.3y.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap312.3y.A1 <- read_csv("SRR6207010_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap312.3y.A2 <- read_csv("SRR6206375_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap312.3y.D1 <- read_csv("SRR6206375_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap312.3y.D2 <- read_csv("SRR6207010_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap312.3y.G1 <- read_csv("SRR6206375_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap312.3y.G2 <- read_csv("SRR6207010_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap312.6m.b1 <- read_csv("SRR6206369_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap312.6m.b1 <- hiv.bulk.cap312.6m.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap312.6m.b2 <- read_csv("SRR6207014_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap312.6m.b2 <- hiv.bulk.cap312.6m.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap312.6m.A1 <- read_csv("SRR6206369_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap312.6m.A2 <- read_csv("SRR6207014_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap312.6m.D1 <- read_csv("SRR6207014_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap312.6m.D2 <- read_csv("SRR6206369_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap312.6m.G1 <- read_csv("SRR6206369_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap312.6m.G2 <- read_csv("SRR6207014_Heavy_IGHG.csv.gz", skip =1)

hiv.bulk.cap312.3y <- rbind(hiv.bulk.cap312.3y.b1,hiv.bulk.cap312.3y.b2,hiv.bulk.cap312.3y.A1,hiv.bulk.cap312.3y.A2,hiv.bulk.cap312.3y.D1,hiv.bulk.cap312.3y.D2,hiv.bulk.cap312.3y.G1,hiv.bulk.cap312.3y.G2)
hiv.bulk.cap312.3y <- hiv.bulk.cap312.3y  %>% filter(Redundancy > 1)
hiv.bulk.cap312.6m <- rbind(hiv.bulk.cap312.6m.b1,hiv.bulk.cap312.6m.b2,hiv.bulk.cap312.6m.A1,hiv.bulk.cap312.6m.A2,hiv.bulk.cap312.6m.D1,hiv.bulk.cap312.6m.D2,hiv.bulk.cap312.6m.G1,hiv.bulk.cap312.6m.G2)
hiv.bulk.cap312.6m <- hiv.bulk.cap312.6m  %>% filter(Redundancy > 1)
#write.table(hiv.bulk.cap312.3y, "hiv_bulk_cap312_3y.tab", sep = "\t", row.names = FALSE, quote = FALSE)
#write.table(hiv.bulk.cap312.6m, "hiv_bulk_cap312_6m.tab", sep = "\t", row.names = FALSE, quote = FALSE)


hiv.bulk.cap322.3y.b1 <- read_csv("SRR6207011_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap322.3y.b1 <- hiv.bulk.cap322.3y.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap322.3y.b2 <- read_csv("SRR6206372_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap322.3y.b2 <- hiv.bulk.cap322.3y.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap322.3y.A1 <- read_csv("SRR6206372_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap322.3y.A2 <- read_csv("SRR6207011_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap322.3y.D1 <- read_csv("SRR6206372_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap322.3y.G1 <- read_csv("SRR6207011_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap322.3y.G2 <- read_csv("SRR6206372_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap322.3y.M1 <- read_csv("SRR6206372_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap322.3y.M2 <- read_csv("SRR6207011_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap322.6m.b1 <- read_csv("SRR6206376_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap322.6m.b1 <- hiv.bulk.cap322.6m.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap322.6m.b2 <- read_csv("SRR6207019_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap322.6m.b2 <- hiv.bulk.cap322.6m.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap322.6m.A1 <- read_csv("SRR6207019_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap322.6m.A2 <- read_csv("SRR6206376_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap322.6m.G1 <- read_csv("SRR6206376_Heavy_IGHG.csv.gz", skip =1)

hiv.bulk.cap322.3y <- rbind(hiv.bulk.cap322.3y.b1,hiv.bulk.cap322.3y.b2,hiv.bulk.cap322.3y.A1,hiv.bulk.cap322.3y.A2,hiv.bulk.cap322.3y.D1,hiv.bulk.cap322.3y.G1,hiv.bulk.cap322.3y.G2,hiv.bulk.cap322.3y.M1,hiv.bulk.cap322.3y.M2)
hiv.bulk.cap322.3y <- hiv.bulk.cap322.3y  %>% filter(Redundancy > 1)
hiv.bulk.cap322.6m <- rbind(hiv.bulk.cap322.6m.b1,hiv.bulk.cap322.6m.b2,hiv.bulk.cap322.6m.A1,hiv.bulk.cap322.6m.A2,hiv.bulk.cap322.6m.G1)
hiv.bulk.cap322.6m <- hiv.bulk.cap322.6m  %>% filter(Redundancy > 1)
#write.table(hiv.bulk.cap322.3y, "hiv_bulk_cap322_3y.tab", sep = "\t", row.names = FALSE, quote = FALSE)
#write.table(hiv.bulk.cap322.6m, "hiv_bulk_cap322_6m.tab", sep = "\t", row.names = FALSE, quote = FALSE)

hiv.bulk.cap335.3y.b1 <- read_csv("SRR6207008_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap335.3y.b1 <- hiv.bulk.cap335.3y.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap335.3y.b2 <- read_csv("SRR6206381_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap335.3y.b2 <- hiv.bulk.cap335.3y.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap335.3y.A1 <- read_csv("SRR6207008_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap335.3y.A2 <- read_csv("SRR6206381_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap335.3y.D1 <- read_csv("SRR6206381_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap335.3y.G1 <- read_csv("SRR6206381_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap335.3y.G2 <- read_csv("SRR6207008_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap335.3y.M1 <- read_csv("SRR6207008_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap335.3y.M2 <- read_csv("SRR6206381_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap335.6m.b1 <- read_csv("SRR6206373_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap335.6m.b1 <- hiv.bulk.cap335.6m.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap335.6m.b2 <- read_csv("SRR6207004_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap335.6m.b2 <- hiv.bulk.cap335.6m.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap335.6m.A1 <- read_csv("SRR6206373_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap335.6m.A2 <- read_csv("SRR6207004_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap335.6m.D1 <- read_csv("SRR6207004_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap335.6m.D2 <- read_csv("SRR6206373_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap335.6m.G1 <- read_csv("SRR6206373_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap335.6m.M1 <- read_csv("SRR6207004_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap335.3y.M2 <- read_csv("SRR6206373_Heavy_IGHM.csv.gz", skip =1)

hiv.bulk.cap335.3y <- rbind(hiv.bulk.cap335.3y.b1,hiv.bulk.cap335.3y.b2,hiv.bulk.cap335.3y.A1,hiv.bulk.cap335.3y.A2,hiv.bulk.cap335.3y.D1,hiv.bulk.cap335.3y.G1,hiv.bulk.cap335.3y.G2,hiv.bulk.cap335.3y.M1,hiv.bulk.cap335.3y.M2)
hiv.bulk.cap335.3y <- hiv.bulk.cap335.3y  %>% filter(Redundancy > 1)
hiv.bulk.cap335.6m <- rbind(hiv.bulk.cap335.6m.b1,hiv.bulk.cap335.6m.b2,hiv.bulk.cap335.6m.A1,hiv.bulk.cap335.6m.A2,hiv.bulk.cap335.6m.D1,hiv.bulk.cap335.6m.D2,hiv.bulk.cap335.6m.G1,hiv.bulk.cap335.6m.M1,hiv.bulk.cap335.3y.M2)
hiv.bulk.cap335.6m <- hiv.bulk.cap335.6m  %>% filter(Redundancy > 1)
#write.table(hiv.bulk.cap335.3y, "hiv_bulk_cap335_3y.tab", sep = "\t", row.names = FALSE, quote = FALSE)
#write.table(hiv.bulk.cap335.6m, "hiv_bulk_cap335_6m.tab", sep = "\t", row.names = FALSE, quote = FALSE)

hiv.bulk.cap351.3y.b1 <- read_csv("SRR6207005_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap351.3y.b1 <- hiv.bulk.cap351.3y.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap351.3y.b2 <- read_csv("SRR6206370_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap351.3y.b2 <- hiv.bulk.cap351.3y.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap351.3y.A1 <- read_csv("SRR6206370_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap351.3y.A2 <- read_csv("SRR6207005_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap351.3y.D1 <- read_csv("SRR6206370_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap351.3y.G1 <- read_csv("SRR6206370_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap351.3y.G2 <- read_csv("SRR6207005_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap351.3y.M1 <- read_csv("SRR6207005_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap351.3y.M2 <- read_csv("SRR6206370_Heavy_IGHM.csv.gz", skip =1)
hiv.bulk.cap351.6m.b1 <- read_csv("SRR6206386_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap351.6m.b1 <- hiv.bulk.cap351.6m.b1  %>% filter(Redundancy > 1)
hiv.bulk.cap351.6m.b2 <- read_csv("SRR6207007_Heavy_Bulk.csv.gz", skip =1)
hiv.bulk.cap351.6m.b2 <- hiv.bulk.cap351.6m.b2  %>% filter(Redundancy > 1)
hiv.bulk.cap351.6m.A1 <- read_csv("SRR6207007_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap351.6m.A2 <- read_csv("SRR6206386_Heavy_IGHA.csv.gz", skip =1)
hiv.bulk.cap351.6m.D1 <- read_csv("SRR6207007_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap351.6m.D2 <- read_csv("SRR6206386_Heavy_IGHD.csv.gz", skip =1)
hiv.bulk.cap351.6m.G1 <- read_csv("SRR6207007_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap351.6m.G2 <- read_csv("SRR6206386_Heavy_IGHG.csv.gz", skip =1)
hiv.bulk.cap351.6m.M1 <- read_csv("SRR6206386_Heavy_IGHM.csv.gz", skip =1)

hiv.bulk.cap351.3y <- rbind(hiv.bulk.cap351.3y.b1,hiv.bulk.cap351.3y.b2,hiv.bulk.cap351.3y.A1,hiv.bulk.cap351.3y.A2,hiv.bulk.cap351.3y.D1,hiv.bulk.cap351.3y.G1,hiv.bulk.cap351.3y.G2,hiv.bulk.cap351.3y.M2)
hiv.bulk.cap351.3y <- hiv.bulk.cap351.3y %>% filter(Redundancy > 1)
hiv.bulk.cap351.6m <- rbind(hiv.bulk.cap351.6m.b1,hiv.bulk.cap351.6m.b2,hiv.bulk.cap351.6m.A1,hiv.bulk.cap351.6m.A2,hiv.bulk.cap351.6m.D1,hiv.bulk.cap351.6m.D2,hiv.bulk.cap351.6m.G1,hiv.bulk.cap351.6m.G2,hiv.bulk.cap351.6m.M1)
hiv.bulk.cap351.6m <- hiv.bulk.cap351.6m  %>% filter(Redundancy > 1)
#write.table(hiv.bulk.cap351.3y, "hiv_bulk_cap351_3y.tab", sep = "\t", row.names = FALSE, quote = FALSE)
#write.table(hiv.bulk.cap351.6m, "hiv_bulk_cap351_6m.tab", sep = "\t", row.names = FALSE, quote = FALSE)
